<!-- HTML header for doxygen 1.8.7-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.7"/>
<title>Enhanced C#: LeMP.IMacroContext Interface Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Enhanced C#
   </div>
   <div id="projectbrief">Language of your choice: library documentation</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<h1>Documentation moved to <a href="http://ecsharp.net/doc/code">ecsharp.net</a></h1>
<small>GitHub doesn't support HTTP redirects, so you'll be redirected in 3 seconds.</small>
<br/><br/>
<script>
setTimeout(function() {
	if (window.location.href.indexOf('http://loyc.net') == 0) {
	  window.location.href = 'http://ecsharp.net' + window.location.href.substr('http://loyc.net'.length);
	}
}, 3000);
</script>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.7 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Properties</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Events</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceLeMP.html">LeMP</a></li><li class="navelem"><a class="el" href="interfaceLeMP_1_1IMacroContext.html">IMacroContext</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#properties">Properties</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="interfaceLeMP_1_1IMacroContext-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">LeMP.IMacroContext Interface Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This interface provides services offered by the lexical macro processor (<a class="el" href="namespaceLeMP.html" title="The lexical macro processor. Main classes: LeMP.Compiler and LeMP.MacroProcessor.">LeMP</a>). 
 <a href="interfaceLeMP_1_1IMacroContext.html#details">More...</a></p>
<hr/><b>Source file</b>:<ul>
<li><a href='https://github.com/qwertie/ecsharp/tree/master/Core/Loyc.Syntax/LeMP/IMacroContext.cs'>/Core/Loyc.Syntax/LeMP/IMacroContext.cs</a></li>
</ul>
<div class="dynheader">
Inheritance diagram for LeMP.IMacroContext:</div>
<div class="dyncontent">
 <div class="center">
  <img src="interfaceLeMP_1_1IMacroContext.png" usemap="#LeMP.IMacroContext_map" alt=""/>
  <map id="LeMP.IMacroContext_map" name="LeMP.IMacroContext_map">
<area href="interfaceLoyc_1_1IMessageSink.html" title="A general-purpose interface for a class that accepts formatted messages with context information..." alt="Loyc.IMessageSink" shape="rect" coords="0,0,131,24"/>
</map>
 </div></div>
<a name="details" id="details"></a><h2 class="groupheader">Remarks</h2>
<div class="textblock"><p>This interface provides services offered by the lexical macro processor (<a class="el" href="namespaceLeMP.html" title="The lexical macro processor. Main classes: LeMP.Compiler and LeMP.MacroProcessor.">LeMP</a>).</p>
<p>Macros receive this as their second argument (see <a class="el" href="namespaceLeMP.html#af4fd3c217e2a127d5546c3b99a7f3576" title="Method signature of an LeMP macro.">LexicalMacro</a>)</p>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="properties"></a>
Properties</h2></td></tr>
<tr class="memitem:a8419c79777d647e75169adb9a3968ee8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="interfaceLoyc_1_1IMessageSink.html">IMessageSink</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a8419c79777d647e75169adb9a3968ee8">Sink</a><code> [get]</code></td></tr>
<tr class="memdesc:a8419c79777d647e75169adb9a3968ee8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the message sink, used for writing warnings and errors. <a href="#a8419c79777d647e75169adb9a3968ee8">More...</a><br /></td></tr>
<tr class="separator:a8419c79777d647e75169adb9a3968ee8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12883b70ba50042d8fbda2e89e43b4f5"><td class="memItemLeft" align="right" valign="top">IDictionary&lt; object, object &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a12883b70ba50042d8fbda2e89e43b4f5">ScopedProperties</a><code> [get]</code></td></tr>
<tr class="memdesc:a12883b70ba50042d8fbda2e89e43b4f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a table of "properties" (arbitrary key-value pairs) that exist in the current scope. This dictionary is "persistent" in the computer science sense; any changes to these properties affect only the current scope and child scopes. When the current scope ends, the set of properties that existed in the parent scope are restored. <a href="#a12883b70ba50042d8fbda2e89e43b4f5">More...</a><br /></td></tr>
<tr class="separator:a12883b70ba50042d8fbda2e89e43b4f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb6b2fbd85b1bb5fb33bf25f04aa890b"><td class="memItemLeft" align="right" valign="top">IReadOnlyList&lt; <a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#abb6b2fbd85b1bb5fb33bf25f04aa890b">Ancestors</a><code> [get]</code></td></tr>
<tr class="memdesc:abb6b2fbd85b1bb5fb33bf25f04aa890b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a list of ancestors of the current node being processed. Normally Ancestors[0] is a #splice node that contains a list of all top-level statements in the file, and Ancestors.Last() is the current node. <a href="#abb6b2fbd85b1bb5fb33bf25f04aa890b">More...</a><br /></td></tr>
<tr class="separator:abb6b2fbd85b1bb5fb33bf25f04aa890b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a681a62874a05eee15058bd1723403ce4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a681a62874a05eee15058bd1723403ce4">Parent</a><code> [get]</code></td></tr>
<tr class="memdesc:a681a62874a05eee15058bd1723403ce4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets the logical parent of the current node, which is <code>Ancestors[Ancestors.Count - 2]</code>, or null if the current node is the root node. <a href="#a681a62874a05eee15058bd1723403ce4">More...</a><br /></td></tr>
<tr class="separator:a681a62874a05eee15058bd1723403ce4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68425589ee09ef9f92085782abf8b53b"><td class="memItemLeft" align="right" valign="top">IListSource&lt; <a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a68425589ee09ef9f92085782abf8b53b">RemainingNodes</a><code> [get]</code></td></tr>
<tr class="memdesc:a68425589ee09ef9f92085782abf8b53b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets a list of the remaining nodes (arguments/statements or attributes) after this point in the code stream. <a href="#a68425589ee09ef9f92085782abf8b53b">More...</a><br /></td></tr>
<tr class="separator:a68425589ee09ef9f92085782abf8b53b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1af6d218898eab6b531fc296fd915c9a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a1af6d218898eab6b531fc296fd915c9a">IsAttribute</a><code> [get]</code></td></tr>
<tr class="memdesc:a1af6d218898eab6b531fc296fd915c9a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the current node is in the attribute list of its immediate parent. <a href="#a1af6d218898eab6b531fc296fd915c9a">More...</a><br /></td></tr>
<tr class="separator:a1af6d218898eab6b531fc296fd915c9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490691aaae9c12a3cc213ad4b1024dbd"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a490691aaae9c12a3cc213ad4b1024dbd">IsTarget</a><code> [get]</code></td></tr>
<tr class="memdesc:a490691aaae9c12a3cc213ad4b1024dbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if the current node is the target of its parent call node. <a href="#a490691aaae9c12a3cc213ad4b1024dbd">More...</a><br /></td></tr>
<tr class="separator:a490691aaae9c12a3cc213ad4b1024dbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada43164412ec526c6e8d081cbb43b5c1"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#ada43164412ec526c6e8d081cbb43b5c1">DropRemainingNodes</a><code> [get, set]</code></td></tr>
<tr class="memdesc:ada43164412ec526c6e8d081cbb43b5c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets or sets a value that indicates whether to drop all remaining node after the current one when the current macro returns. This property has no effect if the macro rejects the input by returning null. <a href="#ada43164412ec526c6e8d081cbb43b5c1">More...</a><br /></td></tr>
<tr class="separator:ada43164412ec526c6e8d081cbb43b5c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7f39549b84ec729a461c784f3a3a0ab"><td class="memItemLeft" align="right" valign="top">IReadOnlyDictionary&lt; <a class="el" href="classLoyc_1_1Symbol.html">Symbol</a>, <br class="typebreak" />
VList&lt; <a class="el" href="classLeMP_1_1MacroInfo.html">MacroInfo</a> &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#ab7f39549b84ec729a461c784f3a3a0ab">AllKnownMacros</a><code> [get]</code></td></tr>
<tr class="memdesc:ab7f39549b84ec729a461c784f3a3a0ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gets information about all macros registered with the macro processor, including macros whose namespace has not been opened with <code>#importMacros</code>. <a href="#ab7f39549b84ec729a461c784f3a3a0ab">More...</a><br /></td></tr>
<tr class="separator:ab7f39549b84ec729a461c784f3a3a0ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2a6f20e79b626a1c314c9442d1beca2e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a2a6f20e79b626a1c314c9442d1beca2e">PreProcessChildren</a> ()</td></tr>
<tr class="memdesc:a2a6f20e79b626a1c314c9442d1beca2e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies all available macros to the current node's children and returns the result. <a href="#a2a6f20e79b626a1c314c9442d1beca2e">More...</a><br /></td></tr>
<tr class="separator:a2a6f20e79b626a1c314c9442d1beca2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5332aac3b0d4fc87e14fef5a8aacb68c"><td class="memItemLeft" align="right" valign="top">VList&lt; <a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a5332aac3b0d4fc87e14fef5a8aacb68c">PreProcess</a> (VList&lt; <a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> &gt; input, bool asRoot=false, bool resetOpenNamespaces=false, bool areAttributes=false)</td></tr>
<tr class="memdesc:a5332aac3b0d4fc87e14fef5a8aacb68c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Runs the macro processor on the specified node(s). <a href="#a5332aac3b0d4fc87e14fef5a8aacb68c">More...</a><br /></td></tr>
<tr class="separator:a5332aac3b0d4fc87e14fef5a8aacb68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7fdedeed7f8a76e677522764b3dee444"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7fdedeed7f8a76e677522764b3dee444"></a>
<a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLeMP_1_1IMacroContext.html#a7fdedeed7f8a76e677522764b3dee444">PreProcess</a> (<a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> input, bool asRoot=false, bool resetOpenNamespaces=false, bool isTarget=false)</td></tr>
<tr class="separator:a7fdedeed7f8a76e677522764b3dee444"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_interfaceLoyc_1_1IMessageSink"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_interfaceLoyc_1_1IMessageSink')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="interfaceLoyc_1_1IMessageSink.html">Loyc.IMessageSink</a></td></tr>
<tr class="memitem:a877aee2f9858d355b0b1876931533f83 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structLoyc_1_1void.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLoyc_1_1IMessageSink.html#a877aee2f9858d355b0b1876931533f83">Write</a> (<a class="el" href="namespaceLoyc.html#aeb4d5c77591b654c8d37485b1dd00f5e">Severity</a> type, object context, string format)</td></tr>
<tr class="memdesc:a877aee2f9858d355b0b1876931533f83 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="mdescLeft">&#160;</td><td class="mdescRight">Writes a message to the target that this object represents. <a href="#a877aee2f9858d355b0b1876931533f83">More...</a><br /></td></tr>
<tr class="separator:a877aee2f9858d355b0b1876931533f83 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5ac60e57472ce79dc502c8a2aedf1a3 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab5ac60e57472ce79dc502c8a2aedf1a3"></a>
<a class="el" href="structLoyc_1_1void.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>Write</b> (<a class="el" href="namespaceLoyc.html#aeb4d5c77591b654c8d37485b1dd00f5e">Severity</a> type, object context, string format, object arg0, object arg1=null)</td></tr>
<tr class="separator:ab5ac60e57472ce79dc502c8a2aedf1a3 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc9c0b32f62412122f0d493b44e5ae96 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc9c0b32f62412122f0d493b44e5ae96"></a>
<a class="el" href="structLoyc_1_1void.html">void</a>&#160;</td><td class="memItemRight" valign="bottom"><b>Write</b> (<a class="el" href="namespaceLoyc.html#aeb4d5c77591b654c8d37485b1dd00f5e">Severity</a> type, object context, string format, params object[] args)</td></tr>
<tr class="separator:abc9c0b32f62412122f0d493b44e5ae96 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77fa394b05a1f42adcd07a4d1fc89de5 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfaceLoyc_1_1IMessageSink.html#a77fa394b05a1f42adcd07a4d1fc89de5">IsEnabled</a> (<a class="el" href="namespaceLoyc.html#aeb4d5c77591b654c8d37485b1dd00f5e">Severity</a> type)</td></tr>
<tr class="memdesc:a77fa394b05a1f42adcd07a4d1fc89de5 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns true if messages of the specified type will actually be printed, or false if Write(type, ...) is a no-op. <a href="#a77fa394b05a1f42adcd07a4d1fc89de5">More...</a><br /></td></tr>
<tr class="separator:a77fa394b05a1f42adcd07a4d1fc89de5 inherit pub_methods_interfaceLoyc_1_1IMessageSink"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a5332aac3b0d4fc87e14fef5a8aacb68c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">VList&lt;<a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&gt; LeMP.IMacroContext.PreProcess </td>
          <td>(</td>
          <td class="paramtype">VList&lt; <a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> &gt;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>asRoot</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>resetOpenNamespaces</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>areAttributes</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Runs the macro processor on the specified node(s).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>The node or node list to process.</td></tr>
    <tr><td class="paramname">asRoot</td><td>If false, the nodes are treated as children of the current node (using the current list of ancestors as a basis), otherwise the nodes are processed alone as if they were a separate file.</td></tr>
    <tr><td class="paramname">resetOpenNamespaces</td><td>If false, the set of open namespaces stays the same; if true it is cleared to the set of pre-opened namespaces (<a class="el" href="classLeMP_1_1MacroProcessor.html#ac7d649b15f5b12c664854825151a5fc1" title="Macros in these namespaces will be available without an explicit import command (#importMacros). By default this list has one item: @LeMP.Prelude (i.e. (Symbol)&quot;LeMP.Prelude&quot;)">MacroProcessor.PreOpenedNamespaces</a>).</td></tr>
  </table>
  </dd>
</dl>
<p>The node(s)</p>

</div>
</div>
<a class="anchor" id="a2a6f20e79b626a1c314c9442d1beca2e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> LeMP.IMacroContext.PreProcessChildren </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies all available macros to the current node's children and returns the result.</p>
<p>This method only processes children once. If this method is called again for the same node, it returns a cached result. </p>
<p>If the currently-running macro fails, the result may be thrown away and the effort of processing the children will have been wasted. If the macro succeeds, and its <a class="el" href="namespaceLeMP.html#af4fd3c217e2a127d5546c3b99a7f3576" title="Method signature of an LeMP macro.">LexicalMacro</a> attribute uses the default <code>MacroMode.Normal</code> processing mode, the children will (normally) be processed again after the macro returns. </p>

</div>
</div>
<h2 class="groupheader">Property Documentation</h2>
<a class="anchor" id="ab7f39549b84ec729a461c784f3a3a0ab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IReadOnlyDictionary&lt;<a class="el" href="classLoyc_1_1Symbol.html">Symbol</a>, VList&lt;<a class="el" href="classLeMP_1_1MacroInfo.html">MacroInfo</a>&gt; &gt; LeMP.IMacroContext.AllKnownMacros</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets information about all macros registered with the macro processor, including macros whose namespace has not been opened with <code>#importMacros</code>.</p>

</div>
</div>
<a class="anchor" id="abb6b2fbd85b1bb5fb33bf25f04aa890b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IReadOnlyList&lt;<a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&gt; LeMP.IMacroContext.Ancestors</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a list of ancestors of the current node being processed. Normally Ancestors[0] is a #splice node that contains a list of all top-level statements in the file, and Ancestors.Last() is the current node.</p>
<p>You would expect that Ancestors[N] would contain Ancestors[N+1] as part of the attributes, target or arguments, but this is not always true. The ancestor list contains original versions of each node; when a child node is changed by a macro, the parent is not updated in this list, but macro processing continues for the descendants of that child, so the ancestor list may occasionally seem incoherent.</p>

</div>
</div>
<a class="anchor" id="ada43164412ec526c6e8d081cbb43b5c1"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool LeMP.IMacroContext.DropRemainingNodes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span><span class="mlabel">set</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets or sets a value that indicates whether to drop all remaining node after the current one when the current macro returns. This property has no effect if the macro rejects the input by returning null.</p>
<p>See remarks at <a class="el" href="classLeMP_1_1MacroContext.html#a645c9e0b5a4d7f7fccf6885147fcb307" title="Splits the current node into a pair of &quot;argument&quot; and &quot;body&quot; lists, potentially treating ctx...">MacroContext.GetArgsAndBody</a>.</p>

</div>
</div>
<a class="anchor" id="a1af6d218898eab6b531fc296fd915c9a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool LeMP.IMacroContext.IsAttribute</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the current node is in the attribute list of its immediate parent.</p>

</div>
</div>
<a class="anchor" id="a490691aaae9c12a3cc213ad4b1024dbd"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool LeMP.IMacroContext.IsTarget</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns true if the current node is the target of its parent call node.</p>

</div>
</div>
<a class="anchor" id="a681a62874a05eee15058bd1723403ce4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a> LeMP.IMacroContext.Parent</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets the logical parent of the current node, which is <code>Ancestors[Ancestors.Count - 2]</code>, or null if the current node is the root node.</p>
<p>Please note that the current node may not actually exist in the parent node due to changes made earlier to the current node by other macros (or even the same macro); the Parent property still returns the old version of the parent node.</p>

</div>
</div>
<a class="anchor" id="a68425589ee09ef9f92085782abf8b53b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IListSource&lt;<a class="el" href="classLoyc_1_1Syntax_1_1LNode.html">LNode</a>&gt; LeMP.IMacroContext.RemainingNodes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Gets a list of the remaining nodes (arguments/statements or attributes) after this point in the code stream.</p>
<p>The list is null when processing a target node. </p>
<p>For example, if your macro is called "macro" and it appears in the following context: </p><div class="fragment"><div class="line">{</div>
<div class="line">  a();</div>
<div class="line">  macro(b());</div>
<div class="line">  c();</div>
<div class="line">  d();</div>
<div class="line">}</div>
</div><!-- fragment --><p> Then this list will contain two items, c() and d(). Similarly, if the context is <code>[a, b, macro(c), d, e]</code> then the list will contain the items d and e. </p>

</div>
</div>
<a class="anchor" id="a12883b70ba50042d8fbda2e89e43b4f5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">IDictionary&lt;object, object&gt; LeMP.IMacroContext.ScopedProperties</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns a table of "properties" (arbitrary key-value pairs) that exist in the current scope. This dictionary is "persistent" in the computer science sense; any changes to these properties affect only the current scope and child scopes. When the current scope ends, the set of properties that existed in the parent scope are restored.</p>
<p>Scopes are bounded by curly brace nodes (Call nodes named "{}"). </p>

</div>
</div>
<a class="anchor" id="a8419c79777d647e75169adb9a3968ee8"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="interfaceLoyc_1_1IMessageSink.html">IMessageSink</a> LeMP.IMacroContext.Sink</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">get</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Returns the message sink, used for writing warnings and errors.</p>
<p>For backward compatibility, <a class="el" href="interfaceLeMP_1_1IMacroContext.html" title="This interface provides services offered by the lexical macro processor (LeMP).">IMacroContext</a> itself implements IMessageSink, but if we were starting from scratch you'd have to write output through this property.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.7-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Mar 24 2016 09:22:15 for Enhanced C# by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.7
</small></address>
</body>
</html>
